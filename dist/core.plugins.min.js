/*! core 2014-04-09 */
!function(){function a(a){a&&a.__inheriting__||b.call(this,a)}var b=core.Core,c=b.prototype;a.inherits(b);var d=a.prototype;d.construct=function(a){c.construct.call(this,a)},d.dispose=function(){c.dispose.call(this)},d.findBackgrounds=function(){},core.registerNamespace("CoreParallax",a)}(core.selector,"undefined"!=typeof process&&void 0!==process.arch?GLOBAL:window),function(){function a(a){a&&a.__inheriting__||b.call(this,a)}var b=core.delegates.Module,c=b.prototype;a.inherits(b);var d=a.prototype;d.dispose=function(){c.dispose.call(this)},d.construct=function(a){c.construct.call(this,a)},d.loadImages=function(){this.midW=768,this.smallW=480;for(var a=this.img.length,b=-1,c=0,d=[];b++<a-1;){var e=document.createElement("img");e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.visibility="hidden",d[b]=e,document.body.appendChild(e),e.setAttribute("src",this.img[b].getAttribute("data-src")),e.onload=function(b){c++,this.img[b].style.width=core.rect(d[b]).width+"px",this.img[b].style.height=core.rect(d[b]).height+"px",document.body.removeChild(d[b]),c==a&&(d=null,this.startHandlingImages())}.bind(this,b)}},d.startHandlingImages=function(){for(var a=this.img.length,b=-1;b++<a-1;)this.orig[b]={w:core.rect(this.img[b]).width,h:core.rect(this.img[b]).height},this.img[b].style.backgroundImage="url('"+this.img[b].getAttribute("data-src")+"')",this.img[b].style.backgroundPosition="50% 0",this.img[b].style.backgroundRepeat="no-repeat",this.img[b].style.backgroundAttachment=core.browser.touch?"static":"fixed";window.onresize=this._("onWindowResize"),window.onscroll=this._("onWindowScroll"),this.onWindowResize()},d.initialized=function(){this.img=this.find("[parallax]"),this.img.length||this.el.getAttribute("data-src"),this.setParentSize(),this.offset=200,this.orig=[],this.loadImages()},d.setParentSize=function(){this.parent={size:{width:core.rect(this.el).width,height:core.rect(this.el).height}}},d.onWindowScroll=function(){if(!core.browser.touch)for(var a=this.img.length;a--;){var b=this.img[a].getAttribute("scroll-offset")||.1,c=core.rect(this.img[a]).top;this.img[a].style.backgroundPosition="center "+c*b+"px"}},d.onWindowResize=function(){this.setParentSize();var a=window.innerWidth,b=window.innerHeight;this.stage={w:a,h:b};for(var c=this.img.length,d=-1,e=[];d++<c-1;)if(a<=this.midW&&a>this.smallW&&this.img[d].getAttribute("data-src-medium"))e[d]=document.createElement("img"),e[d].style.position="absolute",e[d].style.left=e[d].style.top="0px",e[d].style.visibility="hidden",document.body.appendChild(e[d]),e[d].setAttribute("src",this.img[d].getAttribute("data-src-medium")),e[d].onload=function(a){this.img[a].style.width=core.rect(e[a]).width+"px",this.img[a].style.height=core.rect(e[a]).height+"px",document.body.removeChild(e[a]),this.img[a].setAttribute("data-src-medium-loaded",1),this.orig[a]={w:core.rect(this.img[a]).width,h:core.rect(this.img[a]).width},this.img[a].style.backgroundImage="url('"+this.img[a].getAttribute("data-src-medium")+"')",this.img[a].style.backgroundPosition="50% 0",this.img[a].style.backgroundRepeat="no-repeat",this.img[a].style.backgroundAttachment=core.browser.touch?"static":"fixed";var b=this.aspectScaleW(this.orig[a].w,this.orig[a].h,this.stage.w+this.offset);b.height<this.parent.size.height&&(b=this.aspectScaleH(this.orig[a].w,this.orig[a].h,this.parent.size.height+this.offset)),this.img[a].style.width=b.width+"px",this.img[a].style.height=b.height+"px",this.checkOverflow()}.bind(this,d);else if(a<=this.smallW&&this.img[d].getAttribute("data-src-small"))e[d]=document.createElement("img"),e[d].style.position="absolute",e[d].style.left=e[d].style.top="0px",e[d].style.visibility="hidden",document.body.appendChild(e[d]),e[d].setAttribute("src",this.img[d].getAttribute("data-src-small")),e[d].onload=function(a){this.img[a].style.width=core.rect(e[a]).width+"px",this.img[a].style.height=core.rect(e[a]).height+"px",document.body.removeChild(e[a]),this.img[a].setAttribute("data-src-small-loaded",1),this.orig[a]={w:core.rect(this.img[a]).width,h:core.rect(this.img[a]).width},this.img[a].style.backgroundImage="url('"+this.img[a].getAttribute("data-src-small")+"')",this.img[a].style.backgroundPosition="50% 0",this.img[a].style.backgroundRepeat="no-repeat",this.img[a].style.backgroundAttachment=core.browser.touch?"static":"fixed";var b=this.aspectScaleW(this.orig[a].w,this.orig[a].h,this.stage.w+this.offset);b.height<this.parent.size.height&&(b=this.aspectScaleH(this.orig[a].w,this.orig[a].h,this.parent.size.height+this.offset)),this.img[a].style.width=b.width+"px",this.img[a].style.height=b.height+"px",this.checkOverflow()}.bind(this,d);else{(this.img[d].getAttribute("data-src-medium")||this.img[d].getAttribute("data-src-small"))&&(this.img[d].style.backgroundImage="url('"+this.img[d].getAttribute("data-src")+"')",this.img[d].style.backgroundPosition="50% 0",this.img[d].style.backgroundRepeat="no-repeat",this.img[d].style.backgroundAttachment=core.browser.touch?"static":"fixed");var f=this.aspectScaleW(this.orig[d].w,this.orig[d].h,this.stage.w+this.offset);f.height<this.parent.size.height&&(f=this.aspectScaleH(this.orig[d].w,this.orig[d].h,this.parent.size.height+this.offset)),this.img[d].style.width=f.width+"px",this.img[d].style.height=f.height+"px",this.checkOverflow()}},d.checkOverflow=function(){for(var a={width:this.parent.size.width,height:this.parent.size.height},b=this.img.length,c=0,d=0;b--;)d=a.height/2-core.rect(this.img[b]).height/2,c=a.width/2-core.rect(this.img[b]).width/2,this.img[b].style.backgroundSize=core.rect(this.img[b]).width+"px "+core.rect(this.img[b]).height,this.img[b].style.left=c+"px",this.img[b].style.top=d+"px";setTimeout(function(){this.onWindowScroll()}.bind(this),100)},d.aspectScaleH=function(a,b,c){return{height:c,width:c/b*a}},d.aspectScaleW=function(a,b,c){return{height:c/a*b,width:c}},core.registerNamespace("window.ResponsiveParallaxBG",a)}(core.selector);